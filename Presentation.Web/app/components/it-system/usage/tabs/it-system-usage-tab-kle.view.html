<div class="clearfix">
    <help-text data-key="it_system_usage_kle" data-default-title="KLE" class="pull-right"></help-text>
</div>

<div class="object-section-container">
    <h4>{{usage.itSystem.name}} <span ng-if="usage.itSystem.disabled">(inaktiv)</span></h4>
    <div class="panel panel-default">
        <div class="panel-heading">
            <i class="glyphicon glyphicon-tasks"></i>
            Tilknyttede opgaver
        </div>
        <div class="panel-body">
            <div data-kle-filter="selectedTaskGroup"></div>
        </div>
        <table class="table table-condensed">
            <thead>
                <tr>
                    <th>
                        <a id="change-task-view" data-ng-click="changeTaskView()">
                            <span data-ng-if="!showAllTasks">Vis alle</span>
                            <span data-ng-if="showAllTasks">Vis valgte</span>
                        </a>
                    </th>
                    <th class="col-xs-2">
                        KLE ID
                        <button data-order-by="'taskKey'" data-paging="pagination"></button>
                    </th>
                    <th class="col-xs-9">
                        KLE Navn
                        <button data-order-by="'description'" data-paging="pagination"></button>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr data-ng-repeat="task in tasklist">
                    <!-- selected -->
                    <td>
                        <input type="checkbox"
                               id="{{task.taskRef.id}}"
                               data-ng-checked="task.isSelected"
                               data-ng-click="save(task)"
                               data-ng-disabled="!hasWriteAccess" />
                        <label data-ng-show="{{task.inherited}}" class="kle-align-input-info">
                            <a uib-tooltip="Denne opgave er nedarvet"><i class="fa fa-info-circle" aria-hidden="true"></i></a>
                        </label>
                    </td>
                    <td>
                        <label for="{{task.taskRef.id}}">{{task.taskRef.taskKey}}</label>
                    </td>
                    <td>
                        <label for="{{task.taskRef.id}}">{{task.taskRef.description}}</label>
                    </td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="3" class="text-center">
                        <span data-pagination-buttons="pagination" data-pagination-total-count="totalCount"></span>
                        <span>
                            <button id="select-all-pages"
                                    class="btn btn-success btn-sm"
                                    data-confirmed-click="selectTaskGroup()"
                                    data-confirm-click="Er du sikker?"
                                    data-ng-if="hasWriteAccess">
                                Vælg alle sider
                            </button>
                            <button id="select-all"
                                    class="btn btn-success btn-sm"
                                    data-confirmed-click="selectAllTasks()"
                                    data-confirm-click="Er du sikker?"
                                    data-ng-if="hasWriteAccess">
                                Vælg alle
                            </button>
                            <button id="deselect-all"
                                    class="btn btn-danger btn-sm"
                                    data-confirmed-click="removeAllTasks()"
                                    data-confirm-click="Er du sikker?"
                                    data-ng-if="hasWriteAccess">
                                Fjern alle
                            </button>
                            <button id="deselect-all-pages"
                                    class="btn btn-danger btn-sm"
                                    data-confirmed-click="removeTaskGroup()"
                                    data-confirm-click="Er du sikker?"
                                    data-ng-if="hasWriteAccess">
                                Fjern alle sider
                            </button>
                        </span>
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>
</div>